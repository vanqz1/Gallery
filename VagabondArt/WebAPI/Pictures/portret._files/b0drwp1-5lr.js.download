if (self.CavalryLogger) { CavalryLogger.start_js(["hSV50"]); }

__d("PhotoWarningScreenConfig",[],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={GraphicEvents:{GRAPHIC_PHOTO_SHOWN_NO_WARNING:"GRAPHIC_PHOTO_SHOWN_NO_WARNING",GRAPHIC_PHOTO_SHOWN_WITH_WARNING:"GRAPHIC_PHOTO_SHOWN_WITH_WARNING",GRAPHIC_PHOTO_WARNING_DISMISSED:"GRAPHIC_PHOTO_WARNING_DISMISSED"},ObjectionableEvents:{INVALIDATE_CONTENT:"invalidate_content",SHOW_WARNING_SCREEN:"show_warning_screen",DISABLE_THUMBNAIL:"disable_thumbnail",WARNING_SCREEN_DISMISSED:"warning_screen_dismissed",WARNING_SCREEN_REENABLED:"warning_screen_reenabled",MARK_OBJECTIONABLE:"mark_objectionable",UNDO_MARK_OBJECTIONABLE:"undo_mark_objectionable",WARNING_SCREEN_CONTENT_FILTER_PREFS_TAPPED:"warning_screen_content_filter_prefs_tapped"},Types:{GRAPHIC:"graphic",OBJECTIONABLE:"objectionable"}};}),null);
__d('ObjectionableContentFilterTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ObjectionableContentFilterLoggerConfig',this.$ObjectionableContentFilterTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ObjectionableContentFilterLoggerConfig',this.$ObjectionableContentFilterTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ObjectionableContentFilterTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ObjectionableContentFilterTypedLogger1=babelHelpers['extends']({},this.$ObjectionableContentFilterTypedLogger1,j);return this;};h.prototype.setContentID=function(j){this.$ObjectionableContentFilterTypedLogger1.content_id=j;return this;};h.prototype.setEvent=function(j){this.$ObjectionableContentFilterTypedLogger1.event=j;return this;};h.prototype.setFilterType=function(j){this.$ObjectionableContentFilterTypedLogger1.filter_type=j;return this;};h.prototype.setVC=function(j){this.$ObjectionableContentFilterTypedLogger1.vc=j;return this;};h.prototype.updateExtraData=function(j){j=c('nullthrows')(c('GeneratedLoggerUtils').serializeMap(j));c('GeneratedLoggerUtils').checkExtraDataFieldNames(j,i);this.$ObjectionableContentFilterTypedLogger1=babelHelpers['extends']({},this.$ObjectionableContentFilterTypedLogger1,j);return this;};h.prototype.addToExtraData=function(j,k){var l={};l[j]=k;return this.updateExtraData(l);};var i={content_id:true,event:true,filter_type:true,vc:true};f.exports=h;}),null);
__d('ImageUtils',['UserAgent_DEPRECATED'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={hasLoaded:function i(j){if(j.naturalWidth!==undefined){return j.complete&&j.width!==0;}else if(j.height==20&&j.width==20&&j.complete){return false;}else if(j.complete===undefined&&c('UserAgent_DEPRECATED').webkit()<500){var k=new Image();k.src=j.src;return k.complete;}return j.complete;}};f.exports=h;}),null);
__d('PhotoEverstoreLogger',['Event','AsyncRequest','ImageUtils'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={BATCH_WINDOW_MS:500,storedLog:[]};function i(){}Object.assign(i,{_log:function k(l){h.storedLog.push(l);if(h.storedLog.length==1)setTimeout(j,h.BATCH_WINDOW_MS);},logImmediately:function k(l){i._log(l);},registerForLogging:function k(l){var m=document.getElementById(l);if(m!=null)if(c('ImageUtils').hasLoaded(m)){i._log(m.src);}else c('Event').listen(m,'load',function(event){i._log(m.src);});}});function j(){var k=h.storedLog;h.storedLog=[];var l=JSON.stringify(k);new (c('AsyncRequest'))().setURI('/ajax/photos/logging/everstore_logging.php').setData({loggedUrls:l}).setMethod('POST').setOption('suppressErrorHandlerWarning',true).setOption('suppressErrorAlerts',true).send();}f.exports=i;}),null);
__d('PhotoSessionLog',['AsyncRequest','Run','URI','Vector','WWWBase'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){}Object.assign(h,{UNKNOWN:0,ESC:1,X:2,OUTSIDE:3,UNLOAD:4,NAVIGATE:5,AGGREGATE:6,LEAVE:7,PERMALINK:0,SNOWLIFT:6,SNOWDOWN:13,AGGREGATION_COUNT:20,set:null,time:null,views:0,fbidList:[],details:{},width:0,height:0,first:false,last:false,logIds:false,version:null,source:null,buttonLikes:0,pagingAction:'',cycle:false,endOfRelevant:false,relevantCount:0,closingTypeToString:function i(j){return {0:'UNKNOWN',1:'ESC',2:'X',3:'OUTSIDE',4:'UNLOAD',5:'NAVIGATE'}[j]||'UNKNOWN';},initLogging:function i(j){this.set=null;this.time=new Date();this.views=0;this.hiResLoads=0;this.fullScreenViews={};this.first=true;this.last=false;this.logIds=false;this.eid='';this.version=j;this.buttonLikes=0;this.pagingAction='';this.cycle=false;this.endOfRelevant=false;this.relevantCount=0;if(j===h.SNOWLIFT){var k=c('Vector').getViewportDimensions();this.width=k.x;this.height=k.y;}},_isSnowlift:function i(){return this.version===h.SNOWLIFT;},setLogFbids:function i(j){this.logIds=j;},setEid:function i(j){this.eid=j;},setPhotoSet:function i(j){this.set=j;},addButtonLike:function i(){this.buttonLikes++;},setPagingAction:function i(j){this.pagingAction=j;},setCycle:function i(j){this.cycle=j;},setEndOfRelevant:function i(j){this.endOfRelevant=j;},setRelevantCount:function i(j){this.relevantCount=j;},setEndMetrics:function i(j){this.endMetrics=j;},setSource:function i(j){this.source=j;},addPhotoView:function i(j,k,l){if(this.logIds&&this.views>=this.AGGREGATION_COUNT)this.logPhotoViews(this.AGGREGATE);this.views++;if(j)this.fbidList.push([j.fbid,j.owner,Date.now()]);if(k)this.hiResLoads++;if(l)this.fullScreenViews[j.fbid]=true;},logEnterFullScreen:function i(j){this.fullScreenViews[j]=true;},addDetailData:function i(j,k){if(!this.details[j])this.details[j]={t:k.num_tags,l:k.has_location,c:k.has_caption,cm:k.comment_count,lk:k.like_count,w:k.width,h:k.height,ad:'{}',p:this.pagingAction};},updateAdData:function i(j,k){if(this.details[j])this.details[j].ad=JSON.stringify(k);},logPhotoViews:function i(j){if(!this.views)return;if(j!=this.AGGREGATE)this.last=true;var k={set:this.set,time:new Date()-this.time,fbids:this.logIds?this.fbidList:[],details:this.logIds?this.details:{},eid:this.eid,first:this.first,last:this.last,close:j?j:this.UNKNOWN,button_likes:this.buttonLikes,version:this.version,endmetric:this.endMetrics,cycle:this.cycle,end_relev:this.endOfRelevant,relev_count:this.relevantCount,source:this.source};if(this.version===h.SNOWLIFT){var l=c('Vector').getViewportDimensions();k.width=l.x||this.width;k.height=l.y||this.height;if(this.hiResLoads>0)k.hires_loads=this.hiResLoads;if(this.last){var m=Object.keys(this.fullScreenViews).length;if(m>0)k.fullscreen=m;}}var n=new (c('URI'))(c('WWWBase').uri).setPath('/ajax/photos/logging/session_logging.php');new (c('AsyncRequest'))().setAllowCrossPageTransition(true).setURI(n).setOption('asynchronous_DEPRECATED',j!=h.UNLOAD).setOption('suppressErrorHandlerWarning',true).setData(k).send();this.views=0;this.hiResLoads=0;this.fbidList=[];this.details={};this.first=false;this.buttonLikes=0;if(this.last){this.set=null;this.logIds=false;this.fullScreenViews={};}}});c('Run').onUnload(function(){h.logPhotoViews(h.UNLOAD);});c('Run').onLeave(function(){h.logPhotoViews(h.LEAVE);});f.exports=h;}),null);
__d('PhotoViewerImage',['PhotoEverstoreLogger','URI','Vector'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._hiResDimensions=i.hiResDimensions&&c('Vector').deserialize(i.hiResDimensions);this._normalDimensions=i.normalDimensions&&c('Vector').deserialize(i.normalDimensions);this._info=i.info;this._video=i.video;this._shouldLog=i.everstoreLogThis;this._hiResSrc=i.hiResSrc;this._normalSrc=i.normalSrc;this._thumbSrc=i.thumbSrc;this._isInverted=false;this._data=i;}h.prototype.getURIString=function(){'use strict';return new (c('URI'))(this._info.permalink).getUnqualifiedURI().toString();};h.prototype.hasHiResDimensions=function(){'use strict';return !!this._hiResDimensions;};h.prototype.getHiResDimensions=function(){'use strict';return this._hiResDimensions;};h.prototype.getNormalDimensions=function(){'use strict';return this._normalDimensions;};h.prototype.getHiResSrc=function(){'use strict';return this._hiResSrc;};h.prototype.getNormalSrc=function(){'use strict';return this._normalSrc;};h.prototype.getThumbSrc=function(){'use strict';return this._thumbSrc;};h.prototype.getInfo=function(){'use strict';return this._info;};h.prototype.getPermalink=function(){'use strict';return this._info.permalink;};h.prototype.getHighestResSrc=function(){'use strict';return this._hiResSrc||this._normalSrc;};h.prototype.preload=function(i){'use strict';var j;if(this.getHighestResSrc())if(i&&!this._resource){this._resource=new Image();this._resource.src=this.getHighestResSrc();j=this._resource.src;if(this._shouldLog)c('PhotoEverstoreLogger').logImmediately(this._resource.src);}else if(!i&&!this._small){this._small=new Image();this._small.src=this._normalSrc||this._hiResSrc;j=this._small.src;if(this._shouldLog)c('PhotoEverstoreLogger').logImmediately(this._small.src);}return j;};h.prototype.setNormalDimensions=function(i,j){'use strict';this._normalDimensions=new (c('Vector'))(i,j);};h.prototype.setHiResDimensions=function(i,j){'use strict';this._hiResDimensions=new (c('Vector'))(i,j);};h.prototype.invertDimensions=function(){'use strict';if(this.hasHiResDimensions())this._hiResDimensions=new (c('Vector'))(this._hiResDimensions.y,this._hiResDimensions.x);this._normalDimensions=new (c('Vector'))(this._normalDimensions.y,this._normalDimensions.x);this._isInverted=!this._isInverted;};h.prototype.copy=function(){'use strict';return new h(this._data);};f.exports=h;}),null);
__d('PhotosConst',[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={VIEWER_PERMALINK:0,VIEWER_SNOWLIFT:6,VIEWER_VAULTBOX:8,VIEWER_SNOWFLAKE:14,VIEWER_COMPOSER:16,VIEWER_CAROUSEL:19,VIEWER_PERMALINK_STRING:'permalink',VIEWER_SNOWLIFT_STRING:'snowlift',VIEWER_VAULTBOX_STRING:'vaultbox',VIEWER_CAROUSEL_STRING:'carousel',BULK_EDITOR:3,BULK_EDITOR_REACT:15,EDITOR_MODAL:17,FLASH_UPLOADER:4,HTML5_UPLOADER:10,SIZE_NORMAL:'n',PIC_NORMAL_FBX_SIZE:180,ALBUM_NAME_MAXLEN:65};f.exports=h;}),null);
__d('PhotosUtils',['Vector'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){}Object.assign(h,{getNearestBox:function i(j,k){var l=Infinity,m=null;for(var n in j){var o=j[n];if(o.contains(k)){var p=k.distanceTo(o.getCenter());if(p<l){l=p;m=n;}}}return m;},absoluteToNormalizedPosition:function i(j,k){var l=c('Vector').getElementPosition(j),m=c('Vector').getElementDimensions(j),n=k.sub(l).mul(100/m.x,100/m.y);n.domain='pure';return n;},normalizedToAbsolutePosition:function i(j,k){var l=c('Vector').getElementPosition(j),m=c('Vector').getElementDimensions(j),n=k.mul(m.x/100,m.y/100).add(l);n.domain='document';return n;},isFacebox:function i(j){return j.match(/^face:/);},isTag:function i(j){return j.match(/^tag:/);}});f.exports=h;}),null);
__d('PhotoPermalinkURI',[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={isValid:function i(j){return h.parse(j)!==null;},parse:function i(j){if(this.isValidLegacy(j)){var k=j.getQueryData();if(k.fbid)return {photo_id:k.fbid,set_token:k.set};if(k.id&&k.pid)return {photo_id:k.id+':'+k.pid,set_token:k.set};return null;}var l=j.getPath();if(l[l.length-1]==='/')l=l.substring(0,l.length-1);var m=l.split('/');if(m.length>=3&&m[2]==='photos')if(m.length===4&&/^\d+$/.exec(m[3])!==null){return {photo_id:m[3],set_token:null};}else if(m.length===5&&/^\d+$/.exec(m[4])!==null)return {photo_id:m[4],set_token:m[3]};return null;},isValidLegacy:function i(j){var k=j.getPath();if(k[k.length-1]==='/')k=k.substring(0,k.length-1);if(k==='/photo.php'||k==='/force_photo/photo.php'||k==='/photo'||k==='/force_photo/photo/index.php'||k==='/photo/index.php'||k==='/force_photo/photo'||k==='/video.php'||k==='/video/video.php')return true;return false;}};f.exports=h;}),null);
__d('PhotoStreamCache',['DOM','HTML','PhotoEverstoreLogger','PhotosConst','PhotoViewerImage','Rect','UIPagelet','URI','Vector','ge'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';}h.prototype.init=function(i,j,k,l,m){'use strict';this.version=i;this.pageletName=j;this.pageletRootID=k;this.tagSuggestionMode=m;this.bufferSize=h.BUFFER_SIZE;this.fullBucketSize=h.FULL_BUCKET_SIZE;this.initError=false;this.isActive=true;this.usesOpaqueCursor=false;this.usesNonCircularPhotoSet=false;this.reachedLeftEnd=false;this.reachedRightEnd=false;this.leftLock=false;this.rightLock=false;this.useAjaxPipe=true;this.logger=l;this.viewAsUser=null;this.reset();};h.prototype.setViewAs=function(i){'use strict';this.viewAsUser=i;};h.prototype.isInViewAsMode=function(){'use strict';return !!this.viewAsUser;};h.prototype.getViewAsUserId=function(){'use strict';return this.viewAsUser;};h.prototype.getUsesOpaqueCursor=function(){'use strict';return this.usesOpaqueCursor;};h.prototype.isNonCircularPhotoSet=function(){'use strict';return this.usesNonCircularPhotoSet;};h.prototype.setReachedLeftEnd=function(){'use strict';this.reachedLeftEnd=true;};h.prototype.setReachedRightEnd=function(){'use strict';this.reachedRightEnd=true;};h.prototype.hasReachedLeftEnd=function(){'use strict';return this.reachedLeftEnd;};h.prototype.hasReachedRightEnd=function(){'use strict';return this.reachedRightEnd;};h.prototype.nonCircularPhotoSetCanPage=function(i){'use strict';if(!this.isNonCircularPhotoSet())return true;if(i<0)return this.getCursorPos()||!this.hasReachedLeftEnd();if(i>0)return this.getLength()-1!=this.getCursorPos()||!this.hasReachedRightEnd();return true;};h.prototype.setUseAjaxPipe=function(i){'use strict';this.useAjaxPipe=i;};h.prototype.reset=function(){'use strict';this.cache={image:{},extra:{},html:{}};this.fbidList=[];this.loaded=false;this.allLoaded=false;this.permalinkMap={};this.position=0;this.totalCount=null;this.firstCursor=null;this.firstCursorIndex=null;this.firstOpaqueCursor=null;};h.prototype.waitForInitData=function(){'use strict';this.fbidList.push(h.INIT_PLACEHOLDER);};h.prototype.destroy=function(){'use strict';this.reset();this.isActive=false;};h.prototype.isLoaded=function(){'use strict';return this.loaded;};h.prototype.canPage=function(){'use strict';if(!this.isLoaded())return false;if(this.totalCount!==null)return this.totalCount>1;if(this.usesNonCircularPhotoSet)return true;return this.getLength()>1;};h.prototype.errorInCurrent=function(){'use strict';if(this.initError){return true;}else if(!this.isLoaded())return false;return this.checkErrorAt(this.getCursor());};h.prototype.getLength=function(){'use strict';return this.fbidList.length;};h.prototype.getPhotoSet=function(){'use strict';return this.photoSetQuery.set;};h.prototype.getPhotoSetQuery=function(){'use strict';return this.photoSetQuery;};h.prototype.getCurrentImageData=function(){'use strict';return this.getImageData(this.getCursor());};h.prototype.getNextImageData=function(){'use strict';if(!this.fbidList||!this.fbidList.length)return null;var i=(this.position+1)%this.fbidList.length;return this.getImageData(this.getCursorAt(i));};h.prototype.getPreviousImageData=function(){'use strict';if(!this.fbidList||!this.fbidList.length)return null;var i=this.fbidList.length,j=(this.position+i-1)%i;return this.getImageData(this.getCursorAt(j));};h.prototype.addViewAsToURI=function(i){'use strict';var j=new (c('URI'))(i);if(this.isInViewAsMode())j.addQueryData({viewas:this.getViewAsUserId()});return j;};h.prototype.getOpaqueCursor=function(i){'use strict';if(this.getImageData(i)){if(this.version===c('PhotosConst').VIEWER_VAULTBOX)return this.getImageData(i).getInfo().opaquecursor;return this.getImageData(i).info.opaquecursor;}if(i==this.firstCursor)return this.firstOpaqueCursor;return null;};h.prototype.getImageData=function(i){'use strict';var j=this.getCacheContent(i,h.IMAGE_DATA);if(j)j.info.permalink=this.addViewAsToURI(j.info.permalink);return j;};h.prototype.getCurrentHtml=function(){'use strict';return this.getCacheContent(this.getCursor(),h.HTML);};h.prototype.getCurrentExtraData=function(){'use strict';return this.getCacheContent(this.getCursor(),h.EXTRA);};h.prototype.getCacheContent=function(i,j){'use strict';if(!i||i===h.ERROR_ID||i===h.INIT_PLACEHOLDER)return null;return this.cache[j][i];};h.prototype.getCursorPos=function(){'use strict';return this.position;};h.prototype.getCursor=function(){'use strict';if(this.position>=0&&this.position<this.getLength())return this.fbidList[this.position];return null;};h.prototype.getCursorAt=function(i){'use strict';return this.fbidList[i];};h.prototype.getCursorForURI=function(i){'use strict';return this.permalinkMap[i];};h.prototype.calculatePositionForMovement=function(i){'use strict';var j=this.position+i;if(this.allLoaded){var k=this.getLength();j=(k+j%k)%k;}return j;};h.prototype.isValidMovement=function(i){'use strict';if(!this.isLoaded()||!this.canPage())return false;var j=this.calculatePositionForMovement(i);return this.getCursor()>0||j>=0&&j<this.getLength();};h.prototype.moveCursor=function(i){'use strict';if(!this.isValidMovement(i))return;this.position=this.calculatePositionForMovement(i);if(i!==0)this.loadMoreIfNeccessary(i>0);};h.prototype.checkErrorAt=function(i){'use strict';if(!this.isLoaded())return false;if(i===h.ERROR_ID)return true;return false;};h.prototype.getRelativeMovement=function(i){'use strict';for(var j=0;j<this.getLength();j++)if(this.fbidList[j]==i)return j-this.position;return null;};h.prototype.preloadImages=function(i){'use strict';var j,k,l=this.getLength(),m=this.cache.image,n=h.BUFFER_SIZE;if(l>n*2){j=(this.position+l-n%l)%l;k=(this.position+n)%l;}else{j=0;k=l-1;}while(j!=k){var o,p=this.fbidList[j],q=i&&i(m[p]);if(this.version===c('PhotosConst').VIEWER_VAULTBOX){o=m[p]&&m[p].preload(q);}else if(m[p]&&m[p].url)if(q&&!m[p].resource){m[p].resource=new Image();m[p].resource.src=m[p].url;o=m[p].url;if(m[p].everstoreLogThis===true)c('PhotoEverstoreLogger').logImmediately(m[p].resource.src);}else if(!q&&!m[p].small){m[p].small=new Image();m[p].small.src=m[p].smallurl||m[p].url;o=m[p].small.src;if(m[p].everstoreLogThis===true)c('PhotoEverstoreLogger').logImmediately(m[p].small.src);}if(this.logger&&o)this.logger.log(o);j=(j+1)%l;}};h.prototype.loadMoreIfNeccessary=function(i){'use strict';if(this.allLoaded||i&&this.rightLock||!i&&this.leftLock)return;var j=i?1:-1,k=this.position+this.bufferSize*j;if(k<0&&!this.checkErrorAt(this.getEndCursor(false))){this.leftLock=true;this.fetch(this.fullBucketSize,false);}else if(k>this.getLength()&&!this.checkErrorAt(this.getEndCursor(true))){this.rightLock=true;this.fetch(this.fullBucketSize,true);}};h.prototype.getEndCursor=function(i){'use strict';return i?this.fbidList[this.getLength()-1]:this.fbidList[0];};h.prototype.calculateRelativeIndex=function(i,j,k){'use strict';if(!this.totalCount)return null;var l=this.fbidList.indexOf(j),m=this.fbidList.indexOf(k);if(l===-1||m===-1)return null;var n=m-l;return (i+n+this.totalCount)%this.totalCount;};h.prototype.calculateDistance=function(i,j){'use strict';var k=this.fbidList.indexOf(i),l=this.fbidList.indexOf(j);if(k===-1||l===-1)return null;return (l-k+this.getLength())%this.getLength();};h.prototype.fetch=function(i,j){'use strict';var k=this.getEndCursor(j),l=babelHelpers['extends']({cursor:k,version:this.version,end:this.getEndCursor(!j),fetchSize:j?i:-1*i,relevant_count:this.relevantCount,opaqueCursor:this.getOpaqueCursor(k),tagSuggestionMode:this.tagSuggestionMode},this.photoSetQuery);if(this.isInViewAsMode())l.viewas=this.getViewAsUserId();if(this.totalCount&&this.firstCursorIndex!==null){l.total=this.totalCount;l.cursorIndex=this.calculateRelativeIndex(this.firstCursorIndex,this.firstCursor,k);}var m=c('ge')(this.pageletRootID);if(!m){m=c('DOM').create('div',{id:this.pageletRootID});c('DOM').appendContent(document.body,m);}c('UIPagelet').loadFromEndpoint(this.pageletName,m,l,{usePipe:this.useAjaxPipe,automatic:true,jsNonblock:true,crossPage:true});if(!this.useAjaxPipe)this.setUseAjaxPipe(true);};h.prototype.storeToCache=function(i){'use strict';var j={};if(!this.isActive)return j;if('error' in i){this.processErrorResult(i.error);j.error=true;return j;}if('init' in i){this.processInitResult(i.init);j.init={logids:i.init.logids,fbid:i.init.fbid,loggedin:i.init.loggedin,fromad:i.init.fromad,withinbusiness:i.init.withinbusiness,eid:i.init.eid};}if('image' in i){this.processImageResult(i.image);j.image=true;}if('data' in i){this.processDataResult(i.data);j.data=true;}return j;};h.prototype.processInitResult=function(i){'use strict';if(this.loaded)return;this.usesOpaqueCursor=i.usesopaquecursor;this.usesNonCircularPhotoSet=i.isnoncircularphotoset;this.loaded=true;this.photoSetQuery=i.query;if(i.bufferSize)this.bufferSize=i.bufferSize;if(i.fullBucketSize)this.fullBucketSize=i.fullBucketSize;if(this.fbidList.length===0){this.fbidList.push(i.fbid);this.rightLock=true;}else{var j=this.fbidList.indexOf(h.INIT_PLACEHOLDER);if(j!=-1)this.fbidList[j]=i.fbid;}this.firstCursor=i.fbid;this.firstOpaqueCursor=i.opaquecursor;if('initIndex' in i&&'totalCount' in i){this.firstCursorIndex=i.initIndex;this.totalCount=i.totalCount;}if(this.version==c('PhotosConst').VIEWER_PERMALINK){var k=i.initialBucketSize?i.initialBucketSize:h.INIT_BUCKET_SIZE;this.fetch(k,true);}};h.prototype.processImageResult=function(i){'use strict';for(var j in i){if(j===this.firstCursor&&i[j].everstoreLogThis)c('PhotoEverstoreLogger').logImmediately(i[j].url);if(this.version===c('PhotosConst').VIEWER_VAULTBOX){var k=i[j];this.cache.image[j]=new (c('PhotoViewerImage'))(k);this.permalinkMap[this.cache.image[j].getURIString()]=j;}else{this.cache.image[j]=i[j];if(i[j].dimensions)this.cache.image[j].dimensions=c('Vector').deserialize(i[j].dimensions);if(i[j].originalDimensions)this.cache.image[j].originalDimensions=c('Vector').deserialize(i[j].originalDimensions);if(i[j].smalldims)this.cache.image[j].smalldims=c('Vector').deserialize(i[j].smalldims);this.permalinkMap[new (c('URI'))(i[j].info.permalink).getUnqualifiedURI().toString()]=j;}}};h.prototype.attachToFbidsList=function(i,j,k){'use strict';if(this.allLoaded)return;if(j===-1){for(var l=i.length-1;l>=0;l--){this.fbidList.unshift(i[l]);this.position++;}this.leftLock=false;}else{for(var m=0;m<i.length;m++)this.fbidList.push(i[m]);this.rightLock=false;}if(k)this.setAllLoaded();};h.prototype.setAllLoaded=function(){'use strict';this.allLoaded=true;if(this.getCursor()===null)this.position=this.calculatePositionForMovement(0);};h.prototype.processDataResult=function(i){'use strict';for(var j in i){if(!this.cache.html[j])this.cache.html[j]={};for(var k in i[j].html){var l=i[j].html[k];if(typeof l==='string')l=c('HTML')(l).getRootNode();if(l.childNodes){this.cache.html[j][k]=Array.from(l.childNodes);}else this.cache.html[j][k]=[];}if(!('extra' in i[j])){this.cache.extra[j]=null;continue;}this.cache.extra[j]={tagRects:{}};if(!Array.isArray(i[j].extra.tagRects))for(var m in i[j].extra.tagRects)if(i[j].extra.tagRects[m])this.cache.extra[j].tagRects[m]=c('Rect').deserialize(i[j].extra.tagRects[m]);Object.keys(i[j].extra).forEach(function(n){if(n=='tagRects')return;this.cache.extra[j][n]=i[j].extra[n];}.bind(this));}};h.prototype.processErrorResult=function(i){'use strict';if(!this.isLoaded()){this.initError=true;return;}var j=i.side,k=[h.ERROR_ID];this.attachToFbidsList(k,j);};h.prototype.setTotalCount=function(i){'use strict';this.totalCount=i;};h.prototype.setFirstCursorIndex=function(i){'use strict';this.firstCursorIndex=i;};Object.assign(h,{ERROR:'error',HTML:'html',IMAGE_DATA:'image',EXTRA:'extra',BUFFER_SIZE:3,INIT_BUCKET_SIZE:4,FULL_BUCKET_SIZE:12,ERROR_ID:-1,INIT_PLACEHOLDER:1});f.exports=h;}),null);
__d('PhotoViewer',['Bootloader','CSS','DOM','emptyFunction'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';this.image=null;this.root=null;this.stream=null;}h.prototype.getEventString=function(i){'use strict';var j=this.getEventPrefix();if(j)return j+'.'+i;return null;};h.prototype.getImage=function(){'use strict';return this.image;};h.prototype.getPosition=function(){'use strict';return this.stream?this.stream.getCursor():null;};h.prototype.getRoot=function(){'use strict';return this.root;};h.prototype.hiliteAllBoxes=function(){'use strict';c('DOM').scry(this.stageWrapper,'div.tagsWrapper div.faceBox').forEach(function(i){c('CSS').addClass(i,'otherActive');});c('DOM').scry(this.stageWrapper,'div.tagsWrapper div.fbPhotosPhotoTagboxBaseComments').forEach(function(i){c('CSS').addClass(i,'otherActive');});};h.bootstrap=function(i,j){'use strict';c('Bootloader').loadModules(["PhotoSnowlift"],function(k){k.bootstrap(i,j);},'PhotoViewer');};Object.assign(h.prototype,{getEventPrefix:c('emptyFunction').thatReturnsNull,getSourceString:c('emptyFunction').thatReturnsNull,getVersionConst:c('emptyFunction').thatReturnsNull,getViewerSource:c('emptyFunction').thatReturnsNull,getViewerSet:c('emptyFunction').thatReturnsNull});f.exports=h;}),null);
__d('PhotoTagSearchPivotLogger',['Banzai'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={};c('Banzai').subscribe(c('Banzai').SHUTDOWN,function(){Object.keys(h).forEach(function(l){var m=h[l];Object.keys(m).forEach(function(n){c('Banzai').post('photo_tag_search_pivot',{source:l,action:n,count:m[n]});});});});var i=/^(perm:)?tag:/,j,k={logImpression:function l(m,n){var o=m in h?h[m]:h[m]={};o[n]=n in o?o[n]+1:1;},logImageImpression:function l(m,n,o){if(j!==n){if(o.some(function(p){return i.test(p);}))this.logImpression(m,'image_impression');j=n;}},logPivotImpression:function l(m,n){if(i.test(n))this.logImpression(m,'pivot_impression');},logShowMorePhotos:function l(){this.logImpression('photoset','show_more_photos');},logHideMorePhotos:function l(){this.logImpression('photoset','hide_more_photos');},logSuggestMorePhotos:function l(){this.logImpression('photoset','suggest_more_photos');},logMorePhotosNavigation:function l(m){c('Banzai').post('photo_tag_search_pivot',{source:'photoset',action:'more_photos_search',query:m,count:1});}};f.exports=k;}),null);
__d('PhotoWarningScreen',['csx','cx','CSS','DOM','EventListener','Parent','XAsyncRequest','PhotoWarningScreenConfig','ObjectionableContentFilterTypedLogger'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';if(k.footer){if(k.storyRootClass){var l=c('Parent').byClass(k.rootElement,k.storyRootClass);if(l)c('DOM').appendContent(l,k.footer);}var m=k.isMobile?c('DOM').scry(k.footer,'a','warn-undo-link').pop():c('DOM').scry(k.footer,"._1kmy").pop();if(m)c('EventListener').listen(m,'click',function(){c('CSS').hide(k.footer);c('CSS').show(k.warningOverlay);c('CSS').addClass(k.innerContent,"_1t6v");if(k.warningType===c('PhotoWarningScreenConfig').Types.OBJECTIONABLE)j.logFilterEvent(c('PhotoWarningScreenConfig').ObjectionableEvents.WARNING_SCREEN_REENABLED,k.responsibleContent,c('PhotoWarningScreenConfig').Types.OBJECTIONABLE);});}c('EventListener').listen(k.seePhotoButton,'click',function(){c('CSS').hide(k.warningOverlay);if(k.footer)c('CSS').show(k.footer);c('CSS').removeClass(k.innerContent,"_1t6v");j.logFilterEvent(c('PhotoWarningScreenConfig').ObjectionableEvents.WARNING_SCREEN_DISMISSED,k.responsibleContent,k.warningType);});c('EventListener').listen(k.warningOverlay,'click',function(event){if(!k.isMobile){var n=c('DOM').scry(event.target,"._2w-t,^._2w-t");if(n.length){var o=n[0].getAttribute('ajaxify');new (c('XAsyncRequest'))(o).send();}event.stopImmediatePropagation();event.preventDefault();}});}j.logFilterEvent=function(event,k,l){k.forEach(function(m){new (c('ObjectionableContentFilterTypedLogger'))().setEvent(event).setContentID(m).setFilterType(l).log();});};f.exports=j;}),null);
__d('PhotoWarningScreenMixin',['csx','cx','CSS','DOM','emptyFunction'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('emptyFunction'),k={getGraphicWarningContainer:j,getGraphicWarningHiddenContent:j,_graphicWarningMarkup:null,_graphicWarningOverlay:null,_graphicWarningHiddenContentWrapper:null,initGraphicWarningDOM:function l(m){this._graphicWarningMarkup=m;this._graphicWarningOverlay=c('DOM').scry(m,"._1t6w").pop();this._graphicWarningHiddenContentWrapper=c('DOM').scry(m,"._1t6x").pop();},showGraphicWarning:function l(){this._graphicWarningOverlay&&c('CSS').show(this._graphicWarningOverlay);if(this.getGraphicWarningContainer().contains(this._graphicWarningMarkup))return;if(this._graphicWarningHiddenContentWrapper){this.getGraphicWarningContainer().replaceChild(this._graphicWarningMarkup,this.getGraphicWarningHiddenContent());c('CSS').addClass(this._graphicWarningHiddenContentWrapper,"_1t6v");this._graphicWarningHiddenContentWrapper.appendChild(this.getGraphicWarningHiddenContent());}},hideGraphicWarning:function l(){if(!this.getGraphicWarningContainer().contains(this._graphicWarningMarkup))return;this.getGraphicWarningContainer().replaceChild(this.getGraphicWarningHiddenContent(),this._graphicWarningMarkup);}};f.exports=k;}),null);